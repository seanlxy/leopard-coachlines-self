/*! cms 2018-03-15 */
!function(a){function b(){var a=$(".video_player"),b=a.data("youtube-id");if(1==a.length&&b){var c=document.createElement("script");c.src="https://www.youtube.com/iframe_api?callback=onYouTubeIframeAPIReady",$("head").append(c)}}a.App=function(){this.config={serviceUrl:"/requests/service",loadedGalleries:{}}},a.App.prototype.init=function(){this.config=$.extend(!0,this.config,jsVars),this.toggleNav(".toggle-snav"),this.toggleElm(".toggle-elm"),this.initNewsletterSignup("#news-signup-form"),this.initCarousel(".gallery-carousel"),this.initPhotoswipe(".gallery-carousel .img.ps-item"),this.initShuffle("#shuffle"),this.initMap(),this.initSlideshow(".banner__slider"),$(".scroll-trigger").on("click",function(a){a.preventDefault();var b=$(".banner__slider-icon").offset().top;scrollPoint=$(window).scrollTop(),scrollPoint<b&&$("html, body").delay(200).animate({scrollTop:b},{duration:350})})},a.App.prototype.getVar=function(a,b){if(b.hasOwnProperty(a))return b[a];for(var c in b)if(b[c].hasOwnProperty(a))return b[c][a];return!1},a.App.prototype.getConfigItem=function(a){return this.getVar(a,this.config)},a.App.prototype.toggleNav=function(a){var b=$(a);b.length&&b.on("click",function(a){a.preventDefault();var b=$(this),c=b.next(".sub-menu");c.length&&(c.toggle(),b.toggleClass("active"))})},a.App.prototype.toggleElm=function(a){var b=$(a);b.length&&b.on("click",function(a){a.preventDefault();var b=$(this),c=$("header nav"),d=$(c),e="active";b.hasClass(e)?(d.removeClass(e),b.removeClass(e)):(d.addClass(e),b.addClass(e),$('[href="'+c+'"]').addClass(e))})},a.App.prototype.matchElmHeight=function(a){var b="string"==typeof a?$(a):a;if(b){b.css("height","auto");var c=0;b.each(function(a,b){var d=$(b),e=d.height();e>c&&(c=e)}),b.css("height",c)}},a.App.prototype.initSlideshow=function(a,b){var c={dots:!1,arrows:!0,autoplay:!0,infinite:!0,speed:500,autoplaySpeed:1e3*app.getConfigItem("slideshow_speed"),fade:!0,cssEase:"linear",prevArrow:'<a href="javascript:;" class="slider__nav slider__nav--prev"><i class="fa fa-angle-left"></i></a>',nextArrow:'<a href="javascript:;" class="slider__nav slider__nav--next"><i class="fa fa-angle-right"></i></a>'};return b=$.extend(!0,c,b),$(a).slick(b)},a.App.prototype.initNewsletterSignup=function(a){var b=$(a);if(b.length){var c=b.find("#newsletter-submit");c.length&&c.on("click",function(a){a.preventDefault();var c=$.trim(b.find("#signup-email").val()),d="",e="text-dange",f=b.find(".msg");if(c){/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(c)?$.post(app.getConfigItem("serviceUrl"),"action=sign-up&email="+c,function(a){return a.msg&&f.removeAttr("class").addClass("msg "+a.type).html(a.msg),a.isValid&&setTimeout(function(){f.removeClass(a.type).html(""),b.find("#full-name").val(""),b.find("#signup-email").val("")},5e3),!1},"json"):d="Invalid email address provided."}else d="Your email address is required.";d&&f.removeAttr("class").addClass("msg "+e).html(d)})}},a.onYouTubeIframeAPIReady=function(){var a,b,c=$(".video_player").get(0),d=$(".video__wrapper"),e=c.getAttribute("data-youtube-id"),f=screen.width,g=screen.height;console.log(e),d.css("overflow","hidden");new YT.Player(c,{videoId:e,width:f,height:g,playerVars:{start:0,autoplay:!0,controls:!1,rel:0,showinfo:!1,modestbranding:!0,loop:1,fs:!1,cc_load_policy:!0,iv_load_policy:3,autohide:!1,modestbranding:1,playlist:e},events:{onReady:function(c){c.target.mute(),a=1.77*g,a<f?(a=f,b=.565*f):b=g,$(".video_player").css({height:b,width:a}).attr({height:b,width:a}),$(".page__photo__caption--ghost").delay(2e3).animate({opacity:"1"},1500).delay(7500).animate({opacity:"0"},1500)}}})},b(),a.App.prototype.initMap=function(){if($("#map-canvas").length){var a,b,c=[["Leopard Coachlines","81 Buchanans Road, Hei Hei PO Box 7353 Christchurch, New Zealand",-43.533707,172.536877,2],["Leopard Coachlines","182 Jervois Rd Herne Bay 1011 Auckland",-36.8456028,174.73634830000003,1]],d=new google.maps.Map(document.getElementById("map-canvas"),{zoom:6,center:{lat:-39.733707,lng:172.536877},mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!1,draggable:$(window).width()>991}),e=new google.maps.InfoWindow,f=new google.maps.MarkerImage("/graphics/sprite.png",null,null,null,new google.maps.Size(21,32),new google.maps.Point(80,0));for(b=0;b<c.length;b++)a=new google.maps.Marker({position:new google.maps.LatLng(c[b][2],c[b][3]),map:d,icon:f,title:c[b][0]}),google.maps.event.addListener(a,"click",function(a,b){return function(){e.setContent("<h5>"+c[b][0]+"</h5><p>"+c[b][1]+"</p>"),e.open(d,a)}}(a,b))}},a.App.prototype.initCarousel=function(a){var b=$(a);slickInst=b.slick({dots:!1,infinite:!0,speed:300,slidesToShow:1,slidesToScroll:1,prevArrow:'<div class="carousel__gallery__prev"><i class="fa fa-caret-left"></i></div>',nextArrow:'<div class="carousel__gallery__next"><i class="fa fa-caret-right"></i></div>',mobileFirst:!0,adaptiveHeight:!1,responsive:[{breakpoint:230,settings:{slidesToShow:1,slidesToScroll:1}},{breakpoint:767,settings:{slidesToShow:2,slidesToScroll:1}},{breakpoint:991,settings:{slidesToShow:3,slidesToScroll:1}},{breakpoint:1200,settings:{slidesToShow:3,slidesToScroll:1}}]})},a.App.prototype.initPhotoswipe=function(a){var b=$(a);if(b.length){var c={index:0,shareEl:!1,preload:[1,2],history:!1,bgOpacity:.8};b.on("click",function(a){a.preventDefault();var b=$(this).data("groups");c.index=$(this).data("key");var d=app.getConfigItem(b);$.each(d,function(a,b){d[a].src=b.full_path}),console.log(b),new PhotoSwipe($(".pswp").get(0),PhotoSwipeUI_Default,d,c).init()})}},a.App.prototype.initShuffle=function(a){var b=$(a),c=this;b.length&&(b.shuffle({group:"all",itemSelector:"figure",speed:450}),$(".shuffle-trigger").on("click",function(a){a.preventDefault(),b.shuffle("shuffle",$(this).attr("data-group")),$(".shuffle-trigger").removeClass("active"),$(this).addClass("active")}),b.on("done.shuffle",function(){c.initPhotoswipeShuffle(a+" .img.ps-item")}))},a.App.prototype.initPhotoswipeShuffle=function(a){var b=$(a);if(b.length){var c=app.getConfigItem("templates").psGallery;0==$(".pswp").length&&$("body").append(c);var d={index:0,shareEl:!1,preload:[1,2],history:!1,bgOpacity:.8};b.on("click",function(b){b.preventDefault();var c=$(this),e=(c.data("gp"),$(a).siblings(".filtered")),f=c.data("fpath"),g=[];if(e.length&&e.each(function(a,b){var c=$(b),d=c.attr("data-fpath"),e=c.attr("title"),f=c.data("size").split("x");g.push({src:d,w:f[0],h:f[1],title:e})}),g.length){var h=$.map(g,function(a,b){return a.src});d.index=h.indexOf(f);new PhotoSwipe($(".pswp").get(0),PhotoSwipeUI_Default,g,d).init()}})}}}(window);var app=new App;